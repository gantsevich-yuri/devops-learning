# Домашнее задание к занятию «SQL. Часть 2»

### Задание 1

Database - "Sakila".
Одним запросом получите информацию о магазине, в котором обслуживается более 300 покупателей, и выведите в результат следующую информацию: 
- фамилия и имя сотрудника из этого магазина;
- город нахождения магазина;
- количество пользователей, закреплённых в этом магазине.

![shema](shema.png)

```
USE sakila;

SELECT 
	str.store_id, 
	stf.first_name, 
	stf.last_name,
	c.city,
	cs.ccount
FROM (
	SELECT 
		store_id, 
		COUNT(*) AS ccount
	FROM customer 
	GROUP BY store_id 
	HAVING COUNT(*) > 300
) cs
JOIN store str ON cs.store_id = str.store_id 
JOIN staff stf ON str.manager_staff_id = stf.staff_id
JOIN address adr ON str.address_id = adr.address_id
JOIN city c ON adr.city_id = c.city_id;
```

![task1](task1.png)


### Задание 2

Получите количество фильмов, продолжительность которых больше средней продолжительности всех фильмов.

### Задание 3

Получите информацию, за какой месяц была получена наибольшая сумма платежей, и добавьте информацию по количеству аренд за этот месяц.


## Дополнительные задания (со звёздочкой*)
Эти задания дополнительные, то есть не обязательные к выполнению, и никак не повлияют на получение вами зачёта по этому домашнему заданию. Вы можете их выполнить, если хотите глубже шире разобраться в материале.

### Задание 4*

Посчитайте количество продаж, выполненных каждым продавцом. Добавьте вычисляемую колонку «Премия». Если количество продаж превышает 8000, то значение в колонке будет «Да», иначе должно быть значение «Нет».

### Задание 5*

Найдите фильмы, которые ни разу не брали в аренду.